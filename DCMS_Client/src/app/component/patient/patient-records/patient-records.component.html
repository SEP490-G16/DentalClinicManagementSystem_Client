<div class="sep-recent-orders">
  <section class="table__header row mt-4 mb-4">
    <div class="col-4">
      <button class="btn button-timekeeping" data-bs-toggle="modal" data-bs-target="#myBNModal"><i
          class="bi bi-plus-circle"></i> Thêm
        bệnh nhân</button>
    </div>
    <div class="input-group col-7">
      <input type="search" class="search-custom" [(ngModel)]="search" (input)="searchPatient()"
        placeholder="Tìm kiếm theo tên, ngày tạo theo Ngày/Tháng/Năm">
    </div>
  </section>
  <div class="table-container">
    <table>
      <thead class="sticky-thead">
        <tr>
          <th style="width: 100px;">Mã bệnh nhân</th>
          <th style="width: 300px;">Tên bệnh nhân</th>
          <th style="width: 150px;">SĐT</th>
          <th style="width: 250px;">Địa chỉ</th>
          <th style="width: 250px;">Ngày tạo hồ sơ</th>
          <th style="width: 100px;">Thao tác</th>
        </tr>
      </thead>
      <tbody>
        <!-- Hiển thị skeleton loader khi đang tìm kiếm -->
        <ng-container *ngIf="isSearching; else dataRows">
          <tr *ngFor="let p of [1, 2, 3, 4, 5]" class="skeleton-row">
            <td class="skeleton-cell"></td>
            <td class="skeleton-cell"></td>
            <td class="skeleton-cell"></td>
            <td class="skeleton-cell"></td>
            <td class="skeleton-cell"></td>
            <td class="skeleton-cell"></td>
          </tr>
        </ng-container>
        <!-- Hiển thị dữ liệu thực tế -->
        <ng-template #dataRows>
          <tr class="hover-patient" *ngFor="let p of searchPatientsList"
            [ngClass]="{'new-record': p.isNew,'pulse': p.isPulsing}" style="cursor: pointer;">
            <td (click)="detail(p.patient_id)" style="width: 100px;">
              {{p.patient_id}}
            </td>
            <td (click)="detail(p.patient_id)" style="width: 300px; justify-content: center;">
              <a style="cursor: pointer;">{{p.patient_name}}</a>
            </td>
            <td (click)="detail(p.patient_id)" style="width: 150px;">
              {{p.phone_number}}
            </td>
            <td (click)="detail(p.patient_id)" style="width: 250px;">
              {{p.address}}
            </td>
            <td (click)="detail(p.patient_id)" style="width: 250px;">
              {{p.created_date | date:"dd/MM/yyyy"}}
            </td>
            <td style="width: 100px;">
              <button class="btn btn-primary" title="Sửa bệnh nhân" (click)="detail(p.patient_id)"
                style="padding: 2px 5px; margin-right: 3px">
                <i class="bi bi-pencil-square"></i>
              </button>
              <button href="#" class="btn btn-danger float-right btn-rounded" title="Xoá bệnh nhân"
                style="padding: 2px 5px" (click)="openDeletePatient(p.patient_id, p.patient_name, $event)">
                <i class="bi bi-trash"></i>
              </button>
            </td>
          </tr>
        </ng-template>
      </tbody>
    </table>
  </div>
  <div class="sep-pagination">
    <a (click)="currentPage > 1 ? pageChanged(currentPage - 1) : null" [class.disabled]="currentPage <= 1"
      style="color: black" title="Trang trước">&laquo;</a>
    <a>{{currentPage}}</a>
    <a [class.disabled]="!hasNextPage" (click)="hasNextPage && pageChanged(currentPage + 1)"
      style="color: black" title="Trang sau">&raquo;</a>
  </div>
</div>

<!-- <app-popup-add-patient></app-popup-add-patient> -->
<app-popup-add-patient (newPatientAdded)="onNewPatientAdded($event)"></app-popup-add-patient>
